<!DOCTYPE html>
<html lang="fa">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ูุฏุฑุช ููุงูุงุช</title>
</head>
<body>
  <!-- ุจุฎุด ูุฑู ุจุฑุง ุงุฑุณุงู ููุงูู -->
  <h1>ุงูุฒูุฏู ููุงูู ุฌุฏุฏ</h1>
  <form id="articleForm">
    <label for="title">ุนููุงู ููุงูู:</label><br>
    <input type="text" id="title" name="title" required><br><br>

    <label for="content">ูุญุชูุง:</label><br>
    <textarea id="content" name="content" required></textarea><br><br>

    <label for="published_date">ุชุงุฑุฎ ุงูุชุดุงุฑ (ูุฑูุช: YYYY-MM-DD HH:MM:SS):</label><br>
    <input type="text" id="published_date" name="published_date" required><br><br>

    <button type="submit">ุงุฑุณุงู ููุงูู</button>
  </form>

  <hr>

  <!-- ุจุฎุด ููุงุด ูุณุช ููุงูุงุช -->
  <h1>ูุณุช ููุงูุงุช</h1>
  <ul id="articles"></ul>

  <script>
    // ุชุงุจุน ุจุฑุง ุฏุฑุงูุช ููุงูุงุช ุงุฒ API ู ููุงุด ุขูโูุง ุฏุฑ ูุณุช
    function fetchArticles() {
      fetch('http://127.0.0.1:5000/api/articles/')
        .then(response => response.json())
        .then(data => {
          const articlesList = document.getElementById("articles");
          articlesList.innerHTML = ""; // ูพุงฺฉุณุงุฒ ูุณุช ูุจู
          data.forEach(article => {
            let li = document.createElement("li");
            li.textContent = `๐ ${article.title}: ${article.content}`;
            articlesList.appendChild(li);
          });
        })
        .catch(error => console.error('ุฎุทุง ุฏุฑ ุฏุฑุงูุช ุฏุงุฏูโูุง:', error));
    }

    // ุฏุฑุงูุช ููุงูุงุช ุฏุฑ ุงุจุชุฏุง
    fetchArticles();

    // ุงุถุงูู ฺฉุฑุฏู ุฑูุฏุงุฏ ุงุฑุณุงู ูุฑู
    document.getElementById('articleForm').addEventListener('submit', function(event) {
      event.preventDefault(); // ุฌููฺฏุฑ ุงุฒ ุจุงุฑฺฏุฐุงุฑ ูุฌุฏุฏ ุตูุญู

      // ุฏุฑุงูุช ููุงุฏุฑ ูุงุฑุฏ ุดุฏู ุฏุฑ ูุฑู
      const title = document.getElementById('title').value;
      const content = document.getElementById('content').value;
      const published_date = document.getElementById('published_date').value;

      // ุณุงุฎุช ุดุก JSON ุจุฑุง ุงุฑุณุงู
      const articleData = {
        title: title,
        content: content,
        published_date: published_date
      };

      // ุงุฑุณุงู ุฏุฑุฎูุงุณุช POST ุจู API
      fetch('http://127.0.0.1:5000/api/articles/', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(articleData)
      })
      .then(response => response.json())
      .then(data => {
        alert('ููุงูู ุจุง ููููุช ุงุถุงูู ุดุฏ!');
        // ูพุงฺฉุณุงุฒ ูุฑู
        document.getElementById('articleForm').reset();
        // ุจูโุฑูุฒุฑุณุงู ูุณุช ููุงูุงุช
        fetchArticles();
      })
      .catch(error => {
        console.error('ุฎุทุง ุฏุฑ ุงุฑุณุงู ููุงูู:', error);
        alert('ุฎุทุง ุฏุฑ ุงุฑุณุงู ููุงูู!');
      });
    });
  </script>
</body>
</html>
